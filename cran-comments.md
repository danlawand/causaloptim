This is a resubmission that adds some new features and bugfixes. 

It was built using R 4.1.0 and checked on the following platforms: 

- Windows 10, R 4.1 on local machine
- Win Builder dev and release
- Rhub builder and github actions on linux platforms
- Rhub builder and github actions on OSX
